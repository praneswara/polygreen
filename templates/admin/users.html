{% extends "admin/base.html" %}
{% block title %}Users{% endblock %}

{% block content %}
<h2 class="mb-4 text-center">ì‚¬ìš©ì</h2>

<!-- ğŸ” SEARCH BAR -->
<input 
    type="text"
    id="userSearch"
    class="form-control mb-3"
    placeholder="ğŸ” ì‚¬ìš©ì ID, ì´ë¦„, ì „í™”ë²ˆí˜¸ ê²€ìƒ‰..."
    onkeyup="filterUsers()"
/>

<div class="table-responsive-lg">
<table class="table custom-table" id="usersTable">
  <thead class="header-table">
    <tr>
      <th>ID</th>
      <th>ì´ë¦„</th>
      <th>ì´ë™í•˜ëŠ”</th>
      <th>ì „ì² ê¸°</th>
      <th>ë³‘</th>
      <th>í–‰ë™</th>
    </tr>
  </thead>
  <tbody class="table-body">
    {% for user in users %}
    <tr>
      <td>{{ user.user_id }}</td>
      <td>{{ user.name }}</td>
      <td>{{ user.mobile }}</td>
      <td>{{ user.points }}</td>
      <td>{{ user.bottles }}</td>
      <td>
        <a href="{{ url_for('admin_user_detail', user_id=user.user_id) }}"
           class="btn btn-sm border-dark border-2 rounded fw-semibold text-wrap view">
          <img src="{{ url_for('static', filename='eye-icons.png')}}" 
               alt="eye" width="18" height="18" class="icon-disappear">
          ë³´ë‹¤
        </a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<button class="btn btn-primary" onclick="downloadUsersPDF()">ğŸ“„ Download Report</button>

</div>

<!-- ğŸ”¥ LIVE SEARCH SCRIPT -->
<script>
function filterUsers() {
    let input = document.getElementById("userSearch");
    let filter = input.value.toLowerCase();
    let table = document.getElementById("usersTable");
    let trs = table.getElementsByTagName("tr");

    for (let i = 1; i < trs.length; i++) {  // skip table header
        let rowText = trs[i].innerText.toLowerCase();

        if (rowText.includes(filter)) {
            trs[i].style.display = "";
        } else {
            trs[i].style.display = "none";
        }
    }
}
</script>

<style>
    .header-table th{
       background-color:#006d71!important;
       color: white;
    }
    .view{
      background-color: #039398!important;
      color: #ffffff !important;
      border: white;
    }
    .view:hover{
      background-color: #535151!important;
    }
    table{
        border-radius: 15px !important;
        overflow: hidden !important;
    }
    @media only screen and (max-width: 750px) {
    .icon-disappear{
      display: none;
    }
    }
    .custom-table th, 
    .custom-table td {
        border: 1px solid #006d71;
        text-align: center;
    }
    table.custom-table tbody tr:nth-child(even) td {
        background-color: #b9ffec !important;
        color: rgb(0, 0, 0) !important;
        font-weight: 600;
    }
    table.custom-table tbody tr:nth-child(odd) td {
        background-color: #ffffff !important;
        color: black !important;
        font-weight: 600;
    }
</style>

{% endblock %}

